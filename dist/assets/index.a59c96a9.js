const we=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};we();function T(){}function _e(e){return e()}function ce(){return Object.create(null)}function G(e){e.forEach(_e)}function Le(e){return typeof e=="function"}function ne(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Xe(e){return Object.keys(e).length===0}function h(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function H(e){e.parentNode.removeChild(e)}function ke(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function de(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Fe(e){return document.createTextNode(e)}function E(){return Fe(" ")}function S(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function i(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function j(e){return e===""?null:+e}function Re(e){return Array.from(e.childNodes)}function A(e,t){e.value=t==null?"":t}function N(e,t,n,l){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,l?"important":"")}function he(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t){l.selected=!0;return}}e.selectedIndex=-1}function qe(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let B;function z(e){B=e}function Me(){if(!B)throw new Error("Function called outside component initialization");return B}function Ee(e){Me().$$.after_update.push(e)}const K=[],Q=[],Z=[],ge=[],Ae=Promise.resolve();let te=!1;function Se(){te||(te=!0,Ae.then(ye))}function V(e){Z.push(e)}const ee=new Set;let Y=0;function ye(){const e=B;do{for(;Y<K.length;){const t=K[Y];Y++,z(t),Pe(t.$$)}for(z(null),K.length=0,Y=0;Q.length;)Q.pop()();for(let t=0;t<Z.length;t+=1){const n=Z[t];ee.has(n)||(ee.add(n),n())}Z.length=0}while(K.length);for(;ge.length;)ge.pop()();te=!1,ee.clear(),z(e)}function Pe(e){if(e.fragment!==null){e.update(),G(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(V)}}const J=new Set;let Oe;function le(e,t){e&&e.i&&(J.delete(e),e.i(t))}function ve(e,t,n,l){if(e&&e.o){if(J.has(e))return;J.add(e),Oe.c.push(()=>{J.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}}function be(e){e&&e.c()}function re(e,t,n,l){const{fragment:r,on_mount:s,on_destroy:f,after_update:c}=e.$$;r&&r.m(t,n),l||V(()=>{const d=s.map(_e).filter(Le);f?f.push(...d):G(d),e.$$.on_mount=[]}),c.forEach(V)}function ie(e,t){const n=e.$$;n.fragment!==null&&(G(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(e,t){e.$$.dirty[0]===-1&&(K.push(e),Se(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function se(e,t,n,l,r,s,f,c=[-1]){const d=B;z(e);const o=e.$$={fragment:null,ctx:null,props:s,update:T,not_equal:r,bound:ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(d?d.$$.context:[])),callbacks:ce(),dirty:c,skip_bound:!1,root:t.target||d.$$.root};f&&f(o.root);let _=!1;if(o.ctx=n?n(e,t.props||{},(g,v,...M)=>{const p=M.length?M[0]:v;return o.ctx&&r(o.ctx[g],o.ctx[g]=p)&&(!o.skip_bound&&o.bound[g]&&o.bound[g](p),_&&Ce(e,g)),v}):[],o.update(),_=!0,G(o.before_update),o.fragment=l?l(o.ctx):!1,t.target){if(t.hydrate){const g=Re(t.target);o.fragment&&o.fragment.l(g),g.forEach(H)}else o.fragment&&o.fragment.c();t.intro&&le(e.$$.fragment),re(e,t.target,t.anchor,t.customElement),ye()}z(d)}class ue{$destroy(){ie(this,1),this.$destroy=T}$on(t,n){const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const r=l.indexOf(n);r!==-1&&l.splice(r,1)}}$set(t){this.$$set&&!Xe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Ne(e){let t,n,l,r,s;return{c(){t=de("svg"),n=de("path"),i(n,"d",e[2]),i(n,"transform",l=`translate(${e[5]}, ${e[6]})`),i(n,"fill","transparent"),i(n,"stroke","black"),i(t,"width",e[0]),i(t,"height",e[1]),i(t,"class","svelte-6id7e0")},m(f,c){x(f,t,c),h(t,n),e[14](n),e[15](t),r||(s=S(t,"wheel",e[7]),r=!0)},p(f,[c]){c&4&&i(n,"d",f[2]),c&96&&l!==(l=`translate(${f[5]}, ${f[6]})`)&&i(n,"transform",l),c&1&&i(t,"width",f[0]),c&2&&i(t,"height",f[1])},i:T,o:T,d(f){f&&H(t),e[14](null),e[15](null),r=!1,s()}}}function Ie(e,t,n){let{width:l=window.innerWidth}=t,{height:r=window.innerHeight}=t,{input:s=""}=t,{x0:f=l/2}=t,{y0:c=r/2}=t,{a0:d=0}=t,{d:o=10}=t,{b:_=Math.PI}=t,g="",v,M,p=0,O=0;Ee(()=>{});function F(u){let R=u.deltaX,y=u.deltaY;n(5,p+=R),n(6,O+=y)}function k(u){Q[u?"unshift":"push"](()=>{M=u,n(4,M)})}function D(u){Q[u?"unshift":"push"](()=>{v=u,n(3,v)})}return e.$$set=u=>{"width"in u&&n(0,l=u.width),"height"in u&&n(1,r=u.height),"input"in u&&n(8,s=u.input),"x0"in u&&n(9,f=u.x0),"y0"in u&&n(10,c=u.y0),"a0"in u&&n(11,d=u.a0),"d"in u&&n(12,o=u.d),"b"in u&&n(13,_=u.b)},e.$$.update=()=>{if(e.$$.dirty&16132){let u=[],R=f,y=c,w=d;n(2,g=`M${f} ${c}`),s.split("").forEach(U=>{let b=o;switch(U){case"F":R+=b*Math.cos(w),y+=b*Math.sin(w),n(2,g+=`L${Math.round(R)} ${Math.round(y)}`);break;case"f":R+=b*Math.cos(w),y+=b*Math.sin(w),n(2,g+=`M${Math.round(R)} ${Math.round(y)}`);break;case"+":w+=_;break;case"-":w-=_;break;case"]":u.length>0&&({x:R,y,a:w}=u.pop()),n(2,g+=`M${Math.round(R)} ${Math.round(y)}`);break;case"[":u.push({x:R,y,a:w});break}})}},[l,r,g,v,M,p,O,F,s,f,c,d,o,_,k,D]}class je extends ue{constructor(t){super(),se(this,t,Ie,Ne,ne,{width:0,height:1,input:8,x0:9,y0:10,a0:11,d:12,b:13})}}function pe(e,t,n){const l=e.slice();return l[13]=t[n],l[15]=n,l}function me(e){let t,n=e[13].name+"",l,r;return{c(){t=m("option"),l=Fe(n),t.__value=r=e[15],t.value=t.__value,i(t,"class","svelte-hnqypm")},m(s,f){x(s,t,f),h(t,l)},p:T,d(s){s&&H(t)}}}function Te(e){let t,n,l,r,s,f,c,d,o,_,g,v,M,p,O,F,k,D,u,R,y,w,U,b,oe,C,W,$,ae,I=e[5],L=[];for(let a=0;a<I.length;a+=1)L[a]=me(pe(e,I,a));return C=new je({props:{input:e[6](e[2],e[3])||"",a0:-Math.PI/2,d:e[1].d,b:e[4](e[1].angle)}}),{c(){t=m("div"),n=m("input"),l=E(),r=m("div"),s=m("label"),s.textContent="angle",f=E(),c=m("input"),d=E(),o=m("input"),_=E(),g=m("div"),v=m("label"),v.textContent="n",M=E(),p=m("input"),O=E(),F=m("div"),k=m("label"),k.textContent="d",D=E(),u=m("input"),R=E(),y=m("div"),w=m("label"),w.textContent="presets",U=E(),b=m("select");for(let a=0;a<L.length;a+=1)L[a].c();oe=E(),be(C.$$.fragment),i(n,"type","text"),i(n,"placeholder","L-System"),i(n,"class","svelte-hnqypm"),i(s,"for","angle"),i(s,"class","svelte-hnqypm"),N(s,"margin-right","10px",!1),i(c,"id","angle"),i(c,"type","range"),i(c,"min","0"),i(c,"max","360"),i(c,"class","svelte-hnqypm"),i(o,"type","number"),i(o,"min","0"),i(o,"max","360"),i(o,"placeholder","angle"),i(o,"class","svelte-hnqypm"),N(o,"width","6ch",!1),i(r,"class","svelte-hnqypm"),N(r,"display","flex",!1),i(v,"for","n"),i(v,"class","svelte-hnqypm"),N(v,"margin-right","10px",!1),i(p,"id","n"),i(p,"type","number"),i(p,"min","0"),i(p,"class","svelte-hnqypm"),i(g,"class","svelte-hnqypm"),N(g,"display","flex",!1),i(k,"for","d"),i(k,"class","svelte-hnqypm"),N(k,"margin-right","10px",!1),i(u,"id","d"),i(u,"type","range"),i(u,"min","1"),i(u,"class","svelte-hnqypm"),i(F,"class","svelte-hnqypm"),N(F,"display","flex",!1),i(w,"for","preset"),i(w,"class","svelte-hnqypm"),i(b,"id","preset"),i(b,"class","svelte-hnqypm"),e[0]===void 0&&V(()=>e[12].call(b)),i(y,"class","svelte-hnqypm"),i(t,"class","wrapper svelte-hnqypm")},m(a,X){x(a,t,X),h(t,n),A(n,e[1].str),h(t,l),h(t,r),h(r,s),h(r,f),h(r,c),A(c,e[1].angle),h(r,d),h(r,o),A(o,e[1].angle),h(t,_),h(t,g),h(g,v),h(g,M),h(g,p),A(p,e[1].n),h(t,O),h(t,F),h(F,k),h(F,D),h(F,u),A(u,e[1].d),h(t,R),h(t,y),h(y,w),h(y,U),h(y,b);for(let P=0;P<L.length;P+=1)L[P].m(b,null);he(b,e[0]),h(t,oe),re(C,t,null),W=!0,$||(ae=[S(n,"input",e[7]),S(c,"change",e[8]),S(c,"input",e[8]),S(o,"input",e[9]),S(p,"input",e[10]),S(u,"change",e[11]),S(u,"input",e[11]),S(b,"change",e[12])],$=!0)},p(a,[X]){if(X&2&&n.value!==a[1].str&&A(n,a[1].str),X&2&&A(c,a[1].angle),X&2&&j(o.value)!==a[1].angle&&A(o,a[1].angle),X&2&&j(p.value)!==a[1].n&&A(p,a[1].n),X&2&&A(u,a[1].d),X&32){I=a[5];let q;for(q=0;q<I.length;q+=1){const fe=pe(a,I,q);L[q]?L[q].p(fe,X):(L[q]=me(fe),L[q].c(),L[q].m(b,null))}for(;q<L.length;q+=1)L[q].d(1);L.length=I.length}X&1&&he(b,a[0]);const P={};X&12&&(P.input=a[6](a[2],a[3])||""),X&2&&(P.d=a[1].d),X&2&&(P.b=a[4](a[1].angle)),C.$set(P)},i(a){W||(le(C.$$.fragment,a),W=!0)},o(a){ve(C.$$.fragment,a),W=!1},d(a){a&&H(t),ke(L,a),ie(C),$=!1,G(ae)}}}function De(e){if(!e)return;let t=e.split(",");if(t.length<3)return console.error("invalid l-system"),{};let n=t[0].split(""),l=t[1],r=t[2].split(" "),s=new Array(r.length),f=new Array(r.length);for(let d=0;d<r.length;d++){const o=r[d];let _=o.split(">");if(_.length!=2)return console.error(`invalid rule: ${o}`),{};s[d]=_[0],f[d]=_[1]}let c={vars:n,axiom:l,preds:s,succs:f};return console.log("valid l-system"),c}function Ke(e,t){if(!(e!=null&&e.axiom))return;let n=e.axiom;for(;t>0;t--)n=n.split("").map(l=>{let r=e.preds.indexOf(l);return r<0?l:e.succs[r]}).join("");return n}function ze(e,t,n){let l,r,s;const f=F=>Math.PI/180*F,c=[{name:"tree 1",str:"F,F,F>F[+F]F[-F]F",n:5,d:3,angle:25.7},{name:"tree 2",str:"F,F,F>F[+F]F[-F][F]",n:5,d:10,angle:20},{name:"tree 3",str:"F,F,F>FF-[-F+F+F]+[+F-F-F]",n:4,d:12,angle:22.5},{name:"tree 4",str:"FX,X,X>F[+X]F[-X]+X F>FF",n:7,d:3,angle:20},{name:"tree 5",str:"FX,X,X>F[+X][-X]FX F>FF",n:7,d:3,angle:25.7},{name:"tree 6",str:"FX,X,X>F-[[X]+X]+F[+FX]-X F>FF",n:5,d:7,angle:22.5},{name:"Koch island",str:"F,F-F-F-F,F>F-F+F+FF-F-F+F",n:3,d:7,angle:90},{name:"Koch island and lakes",str:"Ff,F+F+F+F,F>F+f-FF+F+FF+Ff+FF-f+FF-F-FF-Ff-FFF f>ffffff",n:2,d:7,angle:90},{name:"dragon curve",str:"LR,L,L>L+R R>L-R",n:10,d:7,angle:90},{name:"Sierpinski gasket",str:"LR,R,L>R+L+R R>L-R-L",n:6,d:7,angle:60},{name:"hexagonal Gosper curve",str:"LR,L,L>L+R++R-L--LL-R+ R>-L+RR++R+L--L-R",n:4,d:7,angle:60}];let d=0;function o(F,k){if(!!(F!=null&&F.vars))return F.vars.forEach(D=>k=k.replaceAll(/[A-Z]/g,"F").replaceAll(/[a-z]/g,"f")),k}function _(){l.str=this.value,n(1,l),n(0,d)}function g(){l.angle=j(this.value),n(1,l),n(0,d)}function v(){l.angle=j(this.value),n(1,l),n(0,d)}function M(){l.n=j(this.value),n(1,l),n(0,d)}function p(){l.d=j(this.value),n(1,l),n(0,d)}function O(){d=qe(this),n(0,d)}return e.$$.update=()=>{e.$$.dirty&1&&n(1,l=c[d]),e.$$.dirty&2&&n(2,r=De(l.str)),e.$$.dirty&6&&n(3,s=Ke(r,l.n))},[d,l,r,s,f,c,o,_,g,v,M,p,O]}class Be extends ue{constructor(t){super(),se(this,t,ze,Te,ne,{})}}function Ge(e){let t,n,l;return n=new Be({}),{c(){t=m("main"),be(n.$$.fragment)},m(r,s){x(r,t,s),re(n,t,null),l=!0},p:T,i(r){l||(le(n.$$.fragment,r),l=!0)},o(r){ve(n.$$.fragment,r),l=!1},d(r){r&&H(t),ie(n)}}}class He extends ue{constructor(t){super(),se(this,t,null,Ge,ne,{})}}new He({target:document.getElementById("app")});
